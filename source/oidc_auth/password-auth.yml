---

paths:
  password-auth:
    get:
      summary: Display password authentication form
      description: Shows the password authentication form for OIDC login
      security: [ ]
      tags:
        - OIDC Authentication
      operationId: showPasswordLogin
      parameters:
        - name: authRequestID
          in: query
          required: true
          type: string
          description: Authentication request ID
      produces:
        - text/html
      responses:
        '200':
          description: HTML login form
          schema:
            type: string
        '400':
          $ref: '../shared/standard-responses.yml#/responses/badRequestResponse'
    post:
      summary: Authenticate with username and password
      description: Authenticates a user via username/password for OIDC flow
      security: [ ]
      tags:
        - OIDC Authentication
      operationId: authenticatePassword
      consumes:
        - application/json
        - application/x-www-form-urlencoded
      parameters:
        - name: credentials
          in: body
          required: true
          schema:
            $ref: 'types.yml#/definitions/oidcUpdbCredentials'
      responses:
        '302':
          description: Redirect to callback URL
          headers:
            Location:
              type: string
              description: Callback URL
            totp-required:
              type: string
              description: Indicates if TOTP is required
        '200':
          description: Authentication queries or TOTP required
          schema:
            type: object
            properties:
              authQueries:
                type: array
                items:
                  $ref: 'shared/auth-query.yml#/definitions/authQueryDetail'
        '400':
          $ref: '../shared/standard-responses.yml#/responses/badRequestResponse'
        '401':
          $ref: '../shared/standard-responses.yml#/responses/invalidAuthResponse'

  username-auth:
    get:
      summary: Display username authentication form
      description: Shows the username authentication form for OIDC login (alias for password)
      security: [ ]
      tags:
        - OIDC Authentication
      operationId: showUsernameLogin
      parameters:
        - name: authRequestID
          in: query
          required: true
          type: string
          description: Authentication request ID
      produces:
        - text/html
      responses:
        '200':
          description: HTML login form
          schema:
            type: string
        '400':
          $ref: '../shared/standard-responses.yml#/responses/badRequestResponse'
    post:
      summary: Authenticate with username
      description: Authenticates a user via username for OIDC flow (alias for password auth)
      security: [ ]
      tags:
        - OIDC Authentication
      operationId: authenticateUsername
      consumes:
        - application/json
        - application/x-www-form-urlencoded
      parameters:
        - name: credentials
          in: body
          required: true
          schema:
            $ref: 'types.yml#/definitions/oidcUpdbCredentials'
      responses:
        '302':
          description: Redirect to callback URL
          headers:
            Location:
              type: string
              description: Callback URL
            totp-required:
              type: string
              description: Indicates if TOTP is required
        '200':
          description: Authentication queries or TOTP required
          schema:
            type: object
            properties:
              authQueries:
                type: array
                items:
                  $ref: 'shared/auth-query.yml#/definitions/authQueryDetail'
        '400':
          $ref: '../shared/standard-responses.yml#/responses/badRequestResponse'
        '401':
          $ref: '../shared/standard-responses.yml#/responses/invalidAuthResponse'